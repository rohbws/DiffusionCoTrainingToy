Launching training on one GPU.
Epoch 0:   0%|          | 0/395 [00:00<?, ?it/s]/tmp/ipykernel_57086/1307585270.py:26: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  act = torch.tensor(act).unsqueeze(1).unsqueeze(-1)  # Convert to tensor and shape (bs, 1, 2, 1)
/tmp/ipykernel_57086/1307585270.py:30: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  class_cond = torch.tensor(obs)  # Convert to tensor (bs, class_emb_size)
/tmp/ipykernel_57086/1307585270.py:31: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  t = torch.tensor(t).unsqueeze(-1)  # Convert timestep to tensor (bs, 1)
Epoch 0: 100%|██████████| 395/395 [00:03<00:00, 126.11it/s, loss=1.08, lr=7.9e-5, step=394]  
Epoch 1: 100%|██████████| 395/395 [00:03<00:00, 114.57it/s, loss=0.978, lr=0.0001, step=789]
Epoch 2: 100%|██████████| 395/395 [00:02<00:00, 140.57it/s, loss=0.863, lr=0.0001, step=1184]
Epoch 3: 100%|██████████| 395/395 [00:03<00:00, 117.45it/s, loss=0.797, lr=0.0001, step=1579]
Epoch 4: 100%|██████████| 395/395 [00:02<00:00, 142.57it/s, loss=0.549, lr=0.0001, step=1974]
Epoch 5: 100%|██████████| 395/395 [00:03<00:00, 120.25it/s, loss=0.443, lr=0.0001, step=2369]
Epoch 6: 100%|██████████| 395/395 [00:02<00:00, 136.22it/s, loss=0.39, lr=0.0001, step=2764] 
Epoch 7: 100%|██████████| 395/395 [00:03<00:00, 118.91it/s, loss=0.27, lr=0.0001, step=3159]
Epoch 8: 100%|██████████| 395/395 [00:03<00:00, 128.57it/s, loss=0.346, lr=9.99e-5, step=3554]
Epoch 9: 100%|██████████| 395/395 [00:03<00:00, 118.55it/s, loss=0.362, lr=9.99e-5, step=3949]
Epoch 10: 100%|██████████| 395/395 [00:02<00:00, 143.19it/s, loss=0.27, lr=9.99e-5, step=4344] 
Epoch 11: 100%|██████████| 395/395 [00:03<00:00, 115.63it/s, loss=0.284, lr=9.99e-5, step=4739]
Epoch 12: 100%|██████████| 395/395 [00:02<00:00, 143.03it/s, loss=0.17, lr=9.99e-5, step=5134] 
Epoch 13: 100%|██████████| 395/395 [00:03<00:00, 116.67it/s, loss=0.221, lr=9.98e-5, step=5529]
Epoch 14: 100%|██████████| 395/395 [00:02<00:00, 141.58it/s, loss=0.319, lr=9.98e-5, step=5924]
Epoch 15: 100%|██████████| 395/395 [00:03<00:00, 114.97it/s, loss=0.269, lr=9.98e-5, step=6319]
Epoch 16: 100%|██████████| 395/395 [00:02<00:00, 140.19it/s, loss=0.329, lr=9.98e-5, step=6714]
Epoch 17: 100%|██████████| 395/395 [00:03<00:00, 119.82it/s, loss=0.282, lr=9.97e-5, step=7109]
Epoch 18: 100%|██████████| 395/395 [00:02<00:00, 133.24it/s, loss=0.24, lr=9.97e-5, step=7504] 
Epoch 19: 100%|██████████| 395/395 [00:03<00:00, 121.65it/s, loss=0.195, lr=9.97e-5, step=7899]
Epoch 20: 100%|██████████| 395/395 [00:02<00:00, 132.50it/s, loss=0.257, lr=9.96e-5, step=8294]
Epoch 21: 100%|██████████| 395/395 [00:03<00:00, 120.48it/s, loss=0.266, lr=9.96e-5, step=8689]
Epoch 22: 100%|██████████| 395/395 [00:02<00:00, 140.84it/s, loss=0.299, lr=9.95e-5, step=9084]
Epoch 23: 100%|██████████| 395/395 [00:03<00:00, 111.67it/s, loss=0.254, lr=9.95e-5, step=9479]
Epoch 24: 100%|██████████| 395/395 [00:02<00:00, 139.00it/s, loss=0.284, lr=9.94e-5, step=9874]
Epoch 25: 100%|██████████| 395/395 [00:03<00:00, 115.91it/s, loss=0.29, lr=9.94e-5, step=10269]
Epoch 26: 100%|██████████| 395/395 [00:02<00:00, 151.72it/s, loss=0.303, lr=9.93e-5, step=10664]
Epoch 27: 100%|██████████| 395/395 [00:03<00:00, 120.01it/s, loss=0.249, lr=9.93e-5, step=11059]
Epoch 28: 100%|██████████| 395/395 [00:02<00:00, 141.19it/s, loss=0.266, lr=9.92e-5, step=11454]
Epoch 29: 100%|██████████| 395/395 [00:03<00:00, 124.28it/s, loss=0.238, lr=9.92e-5, step=11849]
Epoch 30: 100%|██████████| 395/395 [00:02<00:00, 141.72it/s, loss=0.275, lr=9.91e-5, step=12244]
Epoch 31: 100%|██████████| 395/395 [00:03<00:00, 125.65it/s, loss=0.342, lr=9.91e-5, step=12639]
Epoch 32: 100%|██████████| 395/395 [00:02<00:00, 151.65it/s, loss=0.305, lr=9.9e-5, step=13034] 
Epoch 33: 100%|██████████| 395/395 [00:03<00:00, 121.13it/s, loss=0.257, lr=9.89e-5, step=13429]
Epoch 34: 100%|██████████| 395/395 [00:02<00:00, 142.25it/s, loss=0.288, lr=9.89e-5, step=13824]
Epoch 35: 100%|██████████| 395/395 [00:03<00:00, 117.81it/s, loss=0.252, lr=9.88e-5, step=14219]
Epoch 36: 100%|██████████| 395/395 [00:02<00:00, 147.52it/s, loss=0.221, lr=9.87e-5, step=14614]
Epoch 37: 100%|██████████| 395/395 [00:03<00:00, 117.44it/s, loss=0.238, lr=9.87e-5, step=15009]
Epoch 38: 100%|██████████| 395/395 [00:02<00:00, 142.41it/s, loss=0.351, lr=9.86e-5, step=15404]
Epoch 39: 100%|██████████| 395/395 [00:03<00:00, 123.76it/s, loss=0.183, lr=9.85e-5, step=15799]
Epoch 40:  18%|█▊        | 70/395 [00:00<00:02, 142.99it/s, loss=0.286, lr=9.85e-5, step=15869]]
